MYISAM和InnoDB

MyISAM使用B+树作为索引结构，叶节点叶节点的data域保存的是存储数据的地址，
主键索引key值唯一，辅助索引key可以重复，二者在结构上相同。 
因此，MyISAM中索引检索的算法为首先按照B+Tree搜索算法搜索索引，如果要找的Key存在，
则取出其data域的值，然后以data域的值为地址，去读取相应数据记录 。
因此，索引文件和数据文件是分开的，从索引中检索到的是数据的地址，而不是数据。

Innodb也是用B+树作为索引结构，但具体实现方式却与MyISAM截然不同，首先，数据表
本身就是按照b+树组织，所以数据文件本身就是主键索引文件。叶节点key值为数据表的主键，
data域为完整的数据记录，因此InnoDB表数据文件本身就是主键索引(这也就是MyISAM可以允许没有主键，
但是Innodb必须有主键的原因）。第二个与MyISAM索引的不同是InnoDB的辅助索引的data域存储
相应数据记录的主键值而不是地址。换句话说，InnoDB的所有辅助索引都引用主键作为data域。

区别：

1、 存储结构
MyISAM：每个MyISAM在磁盘上存储成三个文件。分别为：表定义文件、数据文件、索引文件。
第一个文件的名字以表的名字开始，扩展名指出文件类型。.frm文件存储表定义。
数据文件的扩展名为.MYD (MYData)。
索引文件的扩展名是.MYI (MYIndex)。

InnoDB：所有的表都保存在同一个数据文件中（也可能是多个文件，或者是独立的表空间文件），
InnoDB表的大小只受限于操作系统文件的大小，一般为2GB。

2、 存储空间
MyISAM： MyISAM支持支持三种不同的存储格式：静态表(默认，但是注意数据末尾不能有空格，会被去掉)、
动态表、压缩表。当表在创建之后并导入数据之后，不会再进行修改操作，可以使用压缩表，
极大的减少磁盘的空间占用。

InnoDB： 需要更多的内存和存储，它会在主内存中建立其专用的缓冲池用于高速缓冲数据和索引。

3、 可移植性、备份及恢复
MyISAM：数据是以文件的形式存储，所以在跨平台的数据转移中会很方便。
在备份和恢复时可单独针对某个表进行操作。

InnoDB：免费的方案可以是拷贝数据文件、备份 binlog，或者用 mysqldump，在数据量达到几十G的时候
就相对痛苦了。

4、事务支持
MyISAM：强调的是性能，每次查询具有原子性,其执行数度比InnoDB类型更快，但是不提供事务支持。

InnoDB：提供事务支持事务，外部键等高级数据库功能。 具有事务(commit)、回滚(rollback)和
崩溃修复能力(crash recovery capabilities)的事务安全(transaction-safe (ACID compliant))型表。

5、AUTO_INCREMENT 
MyISAM：可以和其他字段一起建立联合索引。引擎的自动增长列必须是索引，如果是组合索引，
自动增长可以不是第一列，他可以根据前面几列进行排序后递增。

InnoDB：InnoDB中必须包含只有该字段的索引。引擎的自动增长列必须是索引，如果是组合索引
也必须是组合索引的第一列。

6、表锁差异
MyISAM：只支持表级锁，用户在操作myisam表时，select，update，delete，insert语句都会给表自动加锁，
如果加锁以后的表满足insert并发的情况下，可以在表的尾部插入新的数据。

InnoDB：支持事务和行级锁，是innodb的最大特色。行锁大幅度提高了多用户并发操作的新能。
但是InnoDB的行锁，只是在WHERE的主键是有效的，非主键的WHERE都会锁全表的。

7、全文索引MySql全文索引
MyISAM：支持 FULLTEXT类型的全文索引。

InnoDB：不支持FULLTEXT类型的全文索引，但是innodb可以使用sphinx插件支持全文索引，并且效果更好。

8、表主键
MyISAM：允许没有任何索引和主键的表存在，索引都是保存行的地址。

InnoDB：如果没有设定主键或者非空唯一索引，就会自动生成一个6字节的主键(用户不可见)，
数据是主索引的一部分，附加索引保存的是主索引的值。

9、表的具体行数
MyISAM： 保存有表的总行数，如果select count() from table;会直接取出出该值。

InnoDB： 没有保存表的总行数，如果使用select count(*) from table；就会遍历整个表，消耗相当大，
但是在加了wehre条件后，myisam和innodb处理的方式都一样。

10、CRUD操作
MyISAM：如果执行大量的SELECT，MyISAM是更好的选择。

InnoDB：如果你的数据执行大量的INSERT或UPDATE，出于性能方面的考虑，应该使用InnoDB表。

11、外键
MyISAM：不支持。
InnoDB：支持。


MySQL表级锁的锁模式：
表共享读锁（Table Read Lock）和表独占写锁（Table Write Lock）。